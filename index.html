<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>GameGeek</title>
  <!-- å¤–éƒ¨æ¨£å¼ -->
  <link rel="stylesheet" href="gamegeek.css" />
  <link rel="icon"
      href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ®</text></svg>">

  <style>
#slot-center {
  position: relative;
}


/* ç–Šåœ¨ iframe ä¸Šçš„çµ‚ç«¯æ©Ÿè¼¸å‡ºå±¤ */
#game-overlay {
  position: absolute;
  inset: 0;              /* ç­‰åŒæ–¼ top:0; right:0; bottom:0; left:0; */
  padding: 8px 10px;     /* è®“å­—ä¸è¦è²¼é‚Š */
  background: transparent;
  border-radius: 0;
  box-shadow: none;
  
  color: #00ff66;
  font-family: "JetBrains Mono", "Fira Code", Menlo, Consolas, monospace;
  font-size: 11px;
  line-height: 1.4;

  pointer-events: none;  /* ä»»å‹™ï¼šä¸è¦æ“‹åˆ° iframe */
  z-index: 10;
  overflow-y: hidden;      /* è¦ä¸è¦æ²å‹•å¯è‡ªè¡Œæ±ºå®šï¼Œä¿ç•™æ–¹ä¾¿ä½ çœ‹èˆŠ log */
}

/* æ–°å¢ï¼šåŒ…ä½éŠæˆ² + overlay çš„å®¹å™¨ */
#game-wrapper {
  position: relative;
  display: inline-block;  /* å¯¬é«˜è·Ÿè‘— iframe èµ° */
}
  
  </style>

</head>

<body class="landscape">
  <div id="shell">
    <div id="slot-left"></div>

    <div id="slot-center">
      <div id="game-wrapper">
        <iframe id="game" src="about:blank" frameborder="0" scrolling="no" allowfullscreen></iframe>
          <!-- ç–Šåœ¨éŠæˆ²ä¸Šçš„æç¤ºå±¤ -->
          <div id="game-overlay" aria-hidden="true"></div>
      </div>
    </div>

    <div id="slot-right"></div>

    <div id="slot-bottom"></div>
  </div>

<!-- LeafLune Panelï¼ˆlogo + D-Padï¼‰ -->
<section id="panel-leaf" class="panel">
  <div class="brand">
    <img src="leaflune_emoji.png" alt="LeafLune logo">
    <span>LeafLune</span>
  </div>

  <div class="dpad control-block">
    <button class="gbtn" data-key="up"    style="grid-area: up;">â†‘</button>
    <button class="gbtn" data-key="left"  style="grid-area: left;">â†</button>
    <button class="gbtn" data-key="right" style="grid-area: right;">â†’</button>
    <button class="gbtn" data-key="down"  style="grid-area: down;">â†“</button>
  </div>

  <div class="panel-foot">
    <!-- ä¹‹å¾Œ LeafLune é€™é‚Šè¦æ”¾ä»€éº¼å°æŒ‰éˆ•å°±ä¸Ÿé€™è£¡ -->
    <button class="gbtn utility-btn" title="Start">â–·</button>
    <button class="gbtn utility-btn" title="Select">â˜°</button>
    
  </div>
</section>

<!-- GameGeek Panelï¼ˆæ–‡å­— + 1~4 + å…¨è¢å¹•ï¼‰ -->
<section id="panel-geek" class="panel">
  <div class="brand">
    <span>GameGeek</span>
    <span aria-hidden="true">ğŸ®</span>
  </div>

  <div class="actions control-block">
    <button class="gbtn" data-key="btn1" style="grid-area: btn1;">1</button>
    <button class="gbtn" data-key="btn2" style="grid-area: btn2;">2</button>
    <button class="gbtn" data-key="btn3" style="grid-area: btn3;">3</button>
    <button class="gbtn" data-key="btn4" style="grid-area: btn4;">4</button>
  </div>

  <div class="panel-foot">
    <button class="gbtn utility-btn" title="Set">âš™</button>
    <button id="fullscreen-btn" class="gbtn utility-btn" title="å…¨è¢å¹•">â›¶</button>
  </div>
</section>

<script src="gg_rwd.js" ></script>

  <script>


    const fsBtn   = document.getElementById('fullscreen-btn');
    
      const gameFrame = document.getElementById('game');   // â† æ³¨æ„ï¼šæ˜¯ gameFrameï¼Œä¸æ˜¯ game
  const overlay = document.getElementById('game-overlay');

    function toggleFullscreen() {
      if (!document.fullscreenElement) {
        const el = document.documentElement;
        if (el.requestFullscreen) el.requestFullscreen();
        else if (el.webkitRequestFullscreen) el.webkitRequestFullscreen();
      } else {
        if (document.exitFullscreen) document.exitFullscreen();
        else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
      }
    }

    fsBtn.addEventListener('click', toggleFullscreen);


    layout();
    
    
     // ====== æŒ‰éˆ•æç¤ºå±¤ï¼šé¡¯ç¤ºæŒ‰ä¸‹ / æ”¾é–‹çš„æ˜¯å“ªä¸€é¡† ======

  const keyLabelMap = {
    up:    'â†‘',
    down:  'â†“',
    left:  'â†',
    right: 'â†’',
    btn1:  '1',
    btn2:  '2',
    btn3:  '3',
    btn4:  '4',
    start: 'Start',
    select:'Select'
  };

// çµ¦ log ç”¨çš„æ™‚é–“æˆ³ï¼ˆç°¡å–®ç‰ˆï¼‰
  function nowStamp() {
    const d = new Date();
    const hh = String(d.getHours()).padStart(2, '0');
    const mm = String(d.getMinutes()).padStart(2, '0');
    const ss = String(d.getSeconds()).padStart(2, '0');
    const ms = String(d.getMilliseconds()).padStart(3, '0');
    return `${hh}:${mm}:${ss}.${ms}`;
  }

  // åœ¨ overlay è£¡åŠ ä¸€è¡Œ log
  function logOverlay(text) {
    if (!overlay) return;
    const line = document.createElement('div');
    line.textContent = `[${nowStamp()}] ${text}`;
    overlay.appendChild(line);
    // è‡ªå‹•æ²åˆ°æœ€ä¸‹é¢
    overlay.scrollTop = overlay.scrollHeight;
  }

  // ç¶å®šæ‰€æœ‰ data-key æŒ‰éˆ•
  const padButtons = document.querySelectorAll('button[data-key]');

  padButtons.forEach(btn => {
    const key   = btn.dataset.key;
    const label = keyLabelMap[key] || key;

    // æŒ‰ä¸‹
    btn.addEventListener('pointerdown', (e) => {
      e.preventDefault();
      if (btn.setPointerCapture) {
        btn.setPointerCapture(e.pointerId);
      }
      logOverlay(`keydown  ${label}`);
    });

    // æ”¾é–‹ / å–æ¶ˆ / æ»‘å‡ºå»
    const end = (e) => {
      e.preventDefault();
      try {
        if (btn.releasePointerCapture) {
          btn.releasePointerCapture(e.pointerId);
        }
      } catch (err) {}
      logOverlay(`keyup    ${label}`);
    };

    btn.addEventListener('pointerup', end);
    btn.addEventListener('pointercancel', end);
    // btn.addEventListener('pointerleave', end);
  });

  // ä¹‹å¾Œè¦å° iframe å‚³ postMessageï¼Œå°±åœ¨ pointerdown/up é€™è£¡é †ä¾¿åŠ ï¼š
  // gameFrame.contentWindow.postMessage({ ... }, '*');
  </script>
</body>
</html>
        